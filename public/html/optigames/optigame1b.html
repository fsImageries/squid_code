<!-- Imports -->

<link rel="stylesheet" href="../styles/css/optigame.css" />
<!-- <script defer src="../scripts/button.js"></script> -->
<link rel="stylesheet" href="../styles/css/buttons.css" />
<link rel="stylesheet" href="../styles/css/sketch.css" />
<link
  rel="stylesheet"
  href="../../../node_modules/codemirror/lib/codemirror.css"
/>
<link
  rel="stylesheet"
  href="../../../node_modules/codemirror/theme/ambiance.css"
/>
<link
  rel="stylesheet"
  href="../../../node_modules/codemirror/addon/hint/show-hint.css"
/>
<script src="https://cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.js"></script>
<script defer type="module" src="../scripts/bundle_textarea.js"></script>
<script defer src="../scripts/optigame1-2_sketch.js"></script>

<!-- Actual Code -->
<div class="header">
  <h1>Open the gate!</h1>
</div>
<div class="instructions">
  <div class="avatar-img">
    <img
      src="https://www.looper.com/img/gallery/the-uniform-theory-that-will-change-how-you-watch-squid-game/intro-1633370365.jpg"
      alt="avatar"
      class="avatar"
    />
  </div>
  <div class="box1 sb1">
    <p>
      Schnell die Zeit drÃ¤ngt! Hier ist noch ein Tor. Ã–ffne es und verdiene dir
      ein Hinweis fÃ¼r die erste Runde, Spieler: xxxx!
    </p>
  </div>
</div>

<div id="sketchHolder">
  <!-- Our sketch will go here! -->
</div>
<div class="codeinputContainer">
  <textarea id="codeinput">
const gate = "close";
gate = "open";
gate;
  </textarea>
</div>
<div class="task">
  <table class="codeBlock" style="width: 100%">
    <tbody>
      <tr>
        <th class="code">OUTPUT</th>
      </tr>
      <td class="code output">
        Uncaught TypeError: Assignment to constant variable.
      </td>
    </tbody>
  </table>
</div>


<div style="display: flex; justify-content: center; gap: 10vh">
  <div class="go active">
    <a
      href="../html/temp.html?page=optigames/optigame1a"
      class="button"
      type="button"
      ><span>Back</span></a
    >
  </div>

  <div class="go">
    <a href="../html/temp.html?page=Base/base" class="button" type="button"
      ><span>Next</span></a
    >
  </div>
</div>

<script>
  // Check given input for correctness
  // const validate = (val) => {
  //   if (val.includes("let gate")) setter();
  // };

  // // Gets called when given input is correct
  // const setter = () => {
  //   setAnim(true);
  //   // Marshallah bruddi
  //   $(".codeBlock .output").html("You did fine ðŸŽ‰");
  //   $(".go").toggleClass("active", true);
  // };

   // Check given input for correctness
   const validate = (val) => {
    let split_lines = val.split("\n")

    const letReg = /let gate(?: |)=(?: |)(?:'|")close(?:'|");/g;
    const constReg = /const/g;
    let let_check = 0;
    let const_check = 0

    for (let line of split_lines){
      if (line.match(letReg)) let_check++
      if (line.match(constReg)) const_check++
    }

    setter(let_check == 1 && const_check == 0);
  };

  // Gets called when given input is correct
  const setter = (bool) => {
    setAnim(bool);

    if (bool) {
      $(".codeBlock .output").html("Marshallah Bruddi ðŸŽ‰"); // You did fine ðŸŽ‰
      $(".go").toggleClass("active", true)
    }
  };
</script>
